android {
    defaultConfig {
        applicationId "me.aap.fermata"
        versionCode VERSION_CODE
        versionName VERSION_NAME
        setProperty("archivesBaseName", "fermata-$versionName")
    }

    if (localProps['storeFile'] != null) {
        signingConfigs {
            release {
                storeFile file(localProps["storeFile"])
                storePassword localProps["storePassword"]
                keyAlias localProps["keyAlias"]
                keyPassword localProps["keyPassword"]
            }
        }
    }

    sourceSets {
        main {
            java.srcDirs = ['src/main/java', 'src/share/java']
            res.srcDirs = ['src/main/res', 'src/share/res']
        }
    }

    buildTypes {
        release {
            debuggable false
            minifyEnabled true
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), '../proguard-rules.pro'
            signingConfig signingConfigs.release
        }

        debug {
            debuggable true
            applicationIdSuffix '.debug'
        }
    }

    flavorDimensions "version"

    productFlavors {
        mobile {
            dimension "version"
            resValue "string", "app_name", "@string/app_name_mobile"
            buildConfigField "boolean", 'AUTO', 'false'
        }

        auto {
            dimension "version"
            applicationIdSuffix '.auto'
            resValue "string", "app_name", "@string/app_name_auto"
            buildConfigField "boolean", 'AUTO', 'true'

            dependencies {
                implementation fileTree(dir: 'lib/auto', include: ['*.aar'])
            }
        }
    }

    if (findProject(':exoplayer') != null) dynamicFeatures = [':exoplayer', ':vlc']
    else dynamicFeatures = [':vlc']
}

dependencies {
    implementation project(':utils')
    implementation 'androidx.media:media:1.1.0'
    implementation 'androidx.appcompat:appcompat:1.1.0'
    implementation 'com.google.android.material:material:1.2.0-alpha05'
    implementation "androidx.constraintlayout:constraintlayout:2.0.0-beta4"
    implementation 'com.google.android.play:core:1.7.2'
}